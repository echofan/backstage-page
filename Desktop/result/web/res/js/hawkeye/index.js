define("hawkeye/index",["libs/subscribe","libs/template"],function(t,e,o){var r=t("libs/subscribe"),s=t("libs/template");s.helper("numToPercent",function(t){return(100*t).toFixed(2)}),s.helper("shortDate",function(t){return t.substring(4,6)+"."+t.substring(6)});var a={bindEvent:function(){$("body").delegate(".js-tap",$.Func.TAP,function(t){var e=$(this).data("handler");a[e]&&a[e].call(this)})},getFundid:function(t){var e={jsonrpc:"2.0",method:"EagleEyes.EagleEyesInfo",id:54321};$.Func.ajax(e,function(e){e.result&&t&&t(e.result.productclass)})},closeLayer:function(){$(this).parent().parent().removeClass("show")},getEye:function(){var t=this,e={jsonrpc:"2.0",method:"EagleEyes.Broadcast",id:54321,params:{}};$.Func.ajax(e,function(e){var o=e.result,r=o.day.toString();o.newDate=r.substring(0,4)+"年"+r.substring(4,6)+"月"+r.substring(6)+"日";var a=s("broadcast-template",o);$("#broadcast").html(a),t.getHistory(r)})},getHistory:function(t){var e={jsonrpc:"2.0",method:"EagleEyes.BroadcastHistory",id:54321,params:{date:t}};$.Func.ajax(e,function(t){var e=t.result,o=s("probability-template",e);$("#probability").html(o)})},getBlock:function(){var t={jsonrpc:"2.0",method:"EagleEyes.Block",id:54321,params:{}};$.Func.ajax(t,function(t){var e=t.result;if(e&&e.bkdata){e.colors=["block-color1","block-color2","block-color3","block-color4","block-color5","block-color6","block-color7","block-color8","block-color9","block-color10"];var o=s("block-template",e);$("#block").html(o)}else{var o='<li class="empty-li">暂无板块推荐</li>';$("#block").html(o)}})},showSubscribe:function(t){$("#noSubscribe").removeClass("hide"),$("#noSubscribe img").each(function(t,e){var o=$(e).data("src");$(e).attr("src",o)}),$("#nosubscribeBtn").html('<a href="../../pay/pay.html?productid='+t+'"><img src="../res/img/hawkeye/yybb_btn.png" width="100%" alt=""/></a>')},init:function(){var t=this;$.Func.getUserInfo(),t.getFundid(function(e){if($.User.wxgzh){var o=$.User.userid;r.vipService(o,function(o){~$.inArray(e,o)?(t.getEye(),t.getBlock(),$("#subscribe").removeClass("hide")):t.showSubscribe(e)})}else t.showSubscribe(e)}),this.bindEvent()}};o.exports=a});