define("fund/bindphone",[],function(e,n,t){var a={bindEvent:function(){$("body").delegate(".js-tap","click",function(e){var n=$(this).data("handler");a[n]&&a[n].call(this)})},checkPhone:function(){var e=$("#phone").val();e=e.replace(/(^\s+)|(\s+$)/g,"");var n=/^(((13[0-9]{1})|(15[0-9]{1})|(17[0-9]{1})|(18[0-9]{1}))+\d{8})$/;return!!n.test(e)&&e},checkSmsCode:function(e,n){var t=$("#smsCode").val();t&&(t=t.replace(/(^\s+)|(\s+$)/g,""));var a=new RegExp("^\\d{4}$");if(!t||!a.test(t))return $.Func.pop("请输入正确短信验证码！"),!1;var s={jsonrpc:"2.0",method:"Other.VerifyVerificationCode",id:54321,params:{phone:e,code:t}};$.Func.ajax(s,function(e){var t=e.result;t&&(t.status>1?$.Func.pop(t.statusmsg):$.isFunction(n)&&n())})},getSmsCode:function(){var e=this,n=a.checkPhone();if(!n)return $.Func.pop("请输入有效的手机号码！"),!1;var t={jsonrpc:"2.0",method:"Other.SendVerificationCode",id:54321,params:{phone:n}},s=$(e).attr("disabled");s||$.Func.ajax(t,function(n){var t=n.result;if(t){var a=($(e).attr("disabled"),60);$(e).addClass("disabled").attr("disabled","disabled").html(a+"s后重新获取");var s=setInterval(function(){a--,a>0?$(e).html(a+"s后重新获取"):($(e).removeClass("disabled").removeAttr("disabled").html("重新发送"),clearInterval(s))},1e3)}else $.Func.pop(n.error.message)})},back:function(){history.go(-1)},closeLayer:function(){$("#layer").removeClass("show")},submit:function(){var e,n=a.checkPhone(),t=$.Func.cookie.getCookie("gupiaoxianji_location");switch(t){case"wallet":e=$.CONFIG.CLUB;break;default:e=$.CONFIG.INDEX}a.checkSmsCode(n,function(t){$.User.wxapp||$.Func.bindWeixin(n,$.User.unionid,function(){}),$.User.wxgzh?location.href=e:$.Func.bindGZH(n,$.User.openid,function(n){var t=n.result;if(t)switch(t.status){case 1:$("body").addClass("show-result"),setTimeout(function(){location.href=e},2e3);break;case 2:location.href=e;break;default:$.Func.pop(t.statusmsg)}else $.Func.pop(n.error.message)})})},init:function(){$.Func.getUserInfo(),a.bindEvent()}};t.exports=a});